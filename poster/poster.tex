\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
\documentclass[landscape,a0paper,fontscale=0.35]{baposter}



% For graphs
\usepackage{graphicx}
\usepackage{array}
\usepackage{booktabs}
\usepackage{eso-pic}
\usepackage{layout}
\usepackage{fancybox}
\usepackage{calc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{relsize}
\usepackage{multirow}
\usepackage{rotating}
\usepackage{bm}
\usepackage{url}
\usepackage{xfrac}
\usepackage{natbib}
\setcitestyle{round}
\usepackage{mathtools}
\usepackage{cancel}
\usepackage{paralist}
\usepackage{nicefrac}
\usepackage[export]{adjustbox} % loads also graphicx
\usepackage{caption}
\usepackage{xfrac}
\usepackage{multicol}
\newcommand{\figurewidth}{7cm}
\newcommand{\figureheight}{3cm}
\usepackage{palatino}
\usetikzlibrary{calc}
\usepackage{mymacros}
\usepackage{mathabx}

\renewcommand{\sfdefault}{lmss}
\sffamily

\newcommand{\listhead}[1] {\textsc{\underline{#1}}}

\usepackage{tikz,pgfplots}
\pgfplotsset{compat=newest}
\tikzstyle{every picture}+=[remember picture]
\tikzstyle{na} = [baseline=-.5ex]
\everymath{\displaystyle}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{positioning}

\usepackage{wasysym}

\usepackage{algorithm}
\usepackage{algorithmic}

\usepackage{multirow}

\usepackage{tabu}

\usepackage{xspace}
\DeclareRobustCommand{\eg}{e.g.,\@\xspace}
\DeclareRobustCommand{\ie}{i.e.,\@\xspace}
\DeclareRobustCommand{\wrt}{w.r.t.\@\xspace}
\DeclareRobustCommand{\wp}{w.p.\@\xspace}

\usepackage{bm}
\newcommand{\mathbr}[1]{\bm{\mathbf{#1}}}

\usepackage{lettrine}
\usepackage{xspace}

%=============================================
% General commands
%---------------------------------------------

%=============================================
%%Custom commands

%Colors
\definecolor{darkcyan}{rgb}{0.0, 0.55, 0.55}
\definecolor{darkcerulean}{rgb}{0.03, 0.27, 0.49}
\definecolor{crimson}{rgb}{0.86, 0.08, 0.24}
\definecolor{limegreen}{rgb}{0.2, 0.8, 0.2}
\colorlet{fcolor}{darkcerulean}
\colorlet{errcolor}{darkcyan}
\definecolor{projcolor}{named}{black}
\colorlet{dotcolor}{fcolor}
\colorlet{boundcolor}{violet}
\definecolor{newdotcolor}{named}{green}
\definecolor{arrowcolor}{named}{blue}
\definecolor{distcolor}{rgb}{0.36, 0.11, 0.63}
\definecolor{poliblue1}{RGB}{93,138,168} 
\definecolor{poliblue2}{RGB}{41,76,113}
\definecolor{poliblue3}{RGB}{25,43,67}
\definecolor{orangep}{RGB}{251,146,116}

\usetikzlibrary{tikzmark}

%Decorations
\newcommand{\bad}[1]{\textcolor{crimson}{\textbf{#1}}}
\newcommand{\good}[1]{\textcolor{limegreen}{\textbf{#1}}}

\newcommand{\enb}[1]{\textcolor{poliblue1}{\textbf{#1}}}
\newcommand{\eno}[1]{\textcolor{orangep}{\textbf{#1}}}

%Fake items
\newcommand{\tabitem}[1]{~~\llap{\textbullet}~~ #1 \hfill\mbox{}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Some math symbols used in the text
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Multicol Settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\columnsep}{1.5em}
\setlength{\columnseprule}{0mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Save space in lists. Use this after the opening of the list
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\compresslist}{%
\setlength{\itemsep}{1pt}%
\setlength{\parskip}{0pt}%
\setlength{\parsep}{0pt}%
}

\newcommand{\mildcompresslist}{%
\setlength{\itemsep}{2pt}%
\setlength{\parskip}{1pt}%
\setlength{\parsep}{1pt}%
}

\captionsetup{justification=raggedright,singlelinecheck=false}

%Reduce linespace in biblio
\setlength{\bibsep}{1.5pt}

\usepackage[many]{tcolorbox}
\usetikzlibrary{decorations.pathreplacing}

\usepackage{stackengine}
\usepackage{scalerel}
\newcommand\dangersign[1][2ex]{%
	\renewcommand\stacktype{L}%
	\scaleto{\stackon[1.5pt]{\color{crimson}$\triangle$}{\tiny \bfseries{!}}}{#1}%
}

\definecolor{amethyst}{rgb}{0.6, 0.4, 0.8}
%\newcommand{\firstletter}[1]{{\fcolorbox{black}{black}{\scalebox{2}{\fontsize{24pt}{0pt}\selectfont \textcolor{white}{\textbf{#1}}}}}}

%Transparent boxes
\makeatletter 
\renewcommand{\baposter@box@drawbackground@plain}[2]{\tikzset{box colors/.style={fill=#1,fill opacity=1}} \fill[box colors] \baposterBoxGetShape;}
\makeatother

%Plot
\usepgfplotslibrary{fillbetween}
\def \firstmode {4}
\def \secondmode {10}

\def \p {6.2}
\def \newp {9.25}
\def \firstx {7.22}
\def \secondx {8.23}
\pgfplotsset{ticks=none,
	domain=-1:15,
	/pgf/declare function={
		f(\x) = 3+.5*exp(-((\x-\firstmode)/2)^2) + 4*exp(-((\x-\secondmode)/2)^2) - exp(\x - 14) - 2*exp(-\x);
	},
	/pgf/declare function={
		err(\x) = 0.5+0.2*(\x-\p)^2;
	},
	/pgf/declare function={
		bound(\x) = f(\x) - err(\x) - .5;
	},
	layers/my layer set/.define layer set={
		background,
		pre main,
		main,
		foreground
	}{},
	% activate the newly created layer set
	set layers=my layer set,
}

%\newcommand*\firstletter[1]{\tikz[baseline=(char.base)]{
%            \node[shape=circle,draw,inner sep=2pt] (char) {\scalebox{2}{\fontsize{24pt}{0pt}\selectfont \textcolor{white}{\textbf{#1}}}};}}
%\newcommand\firstletter[1]{\tikz{
%            \node[shape=circle,draw] (char) {#1};}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Begin of Document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Here starts the poster
%%%---------------------------------------------------------------------------
%%% Format it to your taste with the options
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\background{%
}


% Define some colors
\definecolor{blue900}{HTML}{0D47A1}
\definecolor{blue800}{HTML}{1565C0}
\definecolor{lightblue}{rgb}{0.145,0.6666,1}

% \begin{tikzpicture}
%  	\pgfmathsetseed{100000}
%  	\foreach \i in {1,...,300}
%		\node[circle,draw=none,fill=violet!15,minimum size=50 + rand * 30]
%        () at (rand * \paperwidth + \paperwidth, rand * \paperheight + \paperheight) {};
%  \end{tikzpicture}

\begin{poster}%
  % Poster Options
  {
  % Show grid to help with alignment
  columns=4,
  grid=false,
  % Column spacing
  colspacing=1em,
  % Color style
  bgColorOne=white,
  bgColorTwo=white,
  borderColor=blue900,
  headerColorOne=blue800,
  headerColorTwo=blue800,
  headerFontColor=white,
  boxColorOne=white,
  boxColorTwo=lightblue,
  % Format of textbox
  textborder=roundedleft,
  % Format of text header
  eyecatcher=true,
  headerborder=closed,
  headerheight=0.095\textheight,
%  textfont=\sc, An example of changing the text font
  headershape=roundedright,
  headershade=shadelr,
  headerfont=\large\bf\textsc, %Sans Serif
  textfont={\setlength{\parindent}{1.5em}},
  boxshade=plain,
%  background=shade-tb,
  background=user,
  linewidth=2pt
  }
  % Eye Catcher
  % {\includegraphics[height=9em]{./pics/airlab_logo_reflect.png}} 
  {\hspace{0.5cm} \includegraphics[height=7.0em]{./pics/polilogo/logoPoliBlue_poster.png} \hspace{2cm}}
%   {\hspace{3.5cm}}
  % Title
  {\bf\textsc{Optimistic Policy Optimization via Multiple Importance Sampling}\vspace{0.1em}}
  % Authors
  {\textsc{Matteo Papini, Alberto M. Metelli, Lorenzo Lupo and Marcello Restelli}\\ 
  {\normalsize \texttt{\{matteo.papini, albertomaria.metelli, marcello.restelli\}@polimi.it, lorenzo.lupo@mail.polimi.it}}
  }
  % University logo
  {% The makebox allows the title to flow into the logo, this is a hack because of the L shaped logo.
    %\includegraphics[height=9.0em]{./pics/PoliMI.pdf}%\hspace{.5cm}
    {\includegraphics[height=7.0em]{../talk/qr.png}}
  }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Now define the boxes that make up the poster
%%%---------------------------------------------------------------------------
%%% Each box has a name and can be placed absolutely or relatively.
%%% The only inconvenience is that you can only specify a relative position 
%%% towards an already declared box. So if you have a box attached to the 
%%% bottom, one to the top and a third one which should be in between, you 
%%% have to specify the top and bottom boxes before you specify the middle 
%%% box.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Motivation and Idea}{name=problem,column=0,row=0,span=1}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\noindent\:\textbf{Problem:}
	\begin{itemize}
		\item \textbf{Policy Optimization (PO)} methods \eno{neglect exploration}
		\item Existing exploration strategies are \eno{undirected}
		\item Lack of \enb{provably efficient} solutions
	\end{itemize}

	\noindent\:\textbf{Idea:} 
	\begin{itemize}
		\item Frame PO as a \textbf{Multi-Armed Bandit (MAB)} over parameter space \emph{with \enb{arm correlation}}
		\item Apply \textbf{Optimism in Face of Uncertainty (OFU)}
	\end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Policy Optimization}{name=polopt,column=0,row=1,span=1, below=problem}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\noindent\: \textbf{Vanilla action-based PO~\citep{peters2008reinforcement}}
	\begin{itemize}
		\item \eno{Continuous} MDP $\left\langle\Sspace,\Aspace,\Tran,\Rew,\gamma,\init\right\rangle$
		\item \textbf{Trajectory} $\tau = s_0, a_0, r_1, s_1, \dots r_H \quad\in\quad \mathcal{T}$
		\item Return $\Rew(\tau) = \sum_{h=0}^{H-1}\gamma^h r_{h+1}$
		\item \enb{Parametric} policy $\pi_{\vtheta}:\Sspace\to\Aspace$ with $\vtheta\in\Theta$
		\item Induced \textbf{trajectory distribution} $p_{\vtheta}(\tau)$
		\item \textbf{Performance} $J(\vtheta) = \mathbb{E}_{\tau\sim p_{\vtheta}}[\Rew(\tau)]$
		\item Find $\vtheta^*=\arg\max_{\vtheta\in\Theta} J(\vtheta)$
	\end{itemize}
\noindent\: \textbf{Parameter-based PO~\citep{sehnke2008policy}:}
\begin{itemize}
	\item \enb{Hyperpolicy} $\nu_{\vxi}(\vtheta)$ with $\vxi\in\Xi$ \quad(\eg Gaussian)
	\item Find $\vxi^* = \arg\max_{\vxi\in\Xi}\mathbb{E}_{\vtheta\sim\nu_{\vxi}}\left[J(\vtheta)\right]$
\end{itemize}

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Policy Optimization as Correlated MAB}{name=ucb,column=0,row=2,span=1, below=polopt}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\noindent\begin{tabular}{ lccc } 
		\hline
		& \textbf{Correlated MAB} & \textbf{PO} & \textbf{PB-PO} \\ 
		Arm & $\vx \in \Xspace$ & $\vtheta \in \Theta$ & $\vxi \in \Xi$ \\
		Outcome & $z \in \mathcal{Z}$ & $\tau \in \mathcal{T}$ & $\vtheta \in \Theta$\\
		Induced distribution  & $p_{\vx}(z)$ & $p_{\vtheta}(\tau)$ & $\nu_{\vxi}(\vtheta)$ \\
		Payoff & $f(z)$ & $\Rew(\tau)$ & $J(\vtheta)$ \\
		\hline
	\end{tabular}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Multiple Importance Sampling}{name=mis,column=1,row=0,span=1}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{itemize}
		\item Samples from several \textbf{behavioral} distributions:\\ 
		$z_0 \sim q_0, z_1 \sim q_1, \dots, z_K \sim q_K$
%		\item \textbf{Target distribution} $p$
		\item Estimate $\mu\coloneqq\mathbb{E}_{z\sim p}\left[f(z)\right]$ under \textbf{target} distribution $p$
%		\item \textbf{Mixture} of behaviorals: $\vphi(z) = \frac{1}{K}\sum_{k=1}^K q_k(z)$
		\item \enb{Balance Heuristic (BH)}~\citep{veach_optimally_1995}:
		\begin{align*}
		&\wh{\mu}_{\text{BH}} \coloneqq \frac{1}{K}\sum_{k=1}^K\underbrace{\frac{p(z_{k})}{\Phi(z_k)}}_{\mathclap{\text{Importance Weight (IW)}}}f(z_{k}),
		&\qquad\underbrace{\Phi(z) = \frac{1}{K}\sum_{k=1}^K q_k(z)}_{\text{mixture}}
		\end{align*}
%		\item Unbiased: $\mathbb{E}[\wh{\mu}_{\text{BH}}] = \mu$
		\item \enb{Unbiased}, but possibly \eno{high-variance}:
			\begin{align*}
				&\Var\left[\wh{\mu}_{\text{BH}}\right] \leq \norm[\infty]{f}^2\frac{d_2(P\|\Phi)}{K} \leq 
				\norm[\infty]{f}^2\frac{1} {\sum_{k=1}^K \frac{1}{ d_{2}(p \| q_k)}} \\
				&\quad d_{2}(p\|q) \coloneqq \int_{\mathcal{Z}}\left(\frac{p(z)}{q(z)}\right)^{2}\de z \qquad \text{(R\'enyi divergence)}
			\end{align*}
	\end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Robust Estimator}{name=robust,column=2,row=0,span=1, bottomaligned=mis}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\begin{itemize}
		\item Importance Sampling estimators are \eno{heavy-tailed}~\citep{metelli2018policy}
		\item This prevents the formation of \emph{exponential} \textbf{Upper Confidence Bounds (UCB)}
		\item Robust estimation via \enb{adaptive truncation}~\citep{bubeck2012regret}:
		\vspace*{-.25cm}
		\begin{align*}\label{eq:truncatedmise}
			&\widecheck{\mu}_{\text{BH}} \coloneqq \frac{1}{K} \sum_{k=1}^K\min \left\{\underbrace{\sqrt{\frac{K d_{2}\left( p \| \Phi  \right)}{\log \frac{1}{\delta}}}}_{\mathclap{\text{truncation}}},  \underbrace{\vphantom{\sqrt{\frac{K d_{2}\left( p \| \Phi  \right)}{\log \frac{1}{\delta}}}}\frac{p(z_{k})}{\Phi(z_k)}}_{\text{IW}} \right\} f(z_{k})
		\end{align*}
		\item Thanks to truncation, with probability at least $1-2\delta$:
		\begin{align*}
			\left|\widecheck{\mu}_{\text{BH}} - \mu\right| \leq \|f\|_{\infty} \left(\sqrt{2} + \frac{4}{3} \right)  \sqrt{\frac{ d_{2}\left( p \| \Phi  \right) \log  \frac{1}{\delta}  }{K}}
		\end{align*}
	\end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{OPTIMIST Algorithm}{name=mab,column=1,row=1,span=2, below=robust}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Regret Analysis}{name=regret,column=1,row=2,span=2, below=ucb, above=bottom}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Implementation}{name=imp,column=3,row=0,span=1}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{Experiments}{name=exp,column=3,row=1,span=1, below=imp}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\headerbox{References}{name=ref,column=3,row=2,span=1, below=exp, above=bottom}{
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\tiny
	\setlength{\bibsep}{0pt plus 0.3ex}
	\bibliographystyle{abbrvnat}
	\begingroup
	\renewcommand{\section}[2]{}%
	\bibliography{poster.bib}
	\endgroup
}

\end{poster}



\end{document}
